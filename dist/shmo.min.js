!function(t){"use strict";Function.prototype.bind||(Function.prototype.bind=function(t){var n=this,i=[].slice.apply(arguments,[1]);return function(){var e=i.slice();return e.push.apply(e,arguments),n.apply(t,e)}}),Object.assign||(Object.assign=function(t,n){var i=function(n){Object.keys(n).forEach(function(i){t[i]=n[i]})};return arguments.length>2?[].slice.apply(arguments,[1]).forEach(i):i(n),t}),Object.setPrototypeOf||(Object.setPrototypeOf=function(t,n){return t.__proto__=n,t}),Date.now||(Date.now=function(){return(new Date).getTime()}),Object.assign(Array.prototype,{first:function(t){t||(t=function(){return!0});var n;return this.some(function(i){return t(i)?(n=i,!0):void 0})?n:void 0},last:function(t){if(!t)return this[this.length-1];for(var n=this.length-1;n>=0;n--){var i=this[n];if(t(i))return i}}}),Array.from||(Array.from=function(t){return Array.prototype.slice.apply(t)}),Array.of||(Array.of=function(){return Array.from(arguments)}),t.setImmediate||(t.setImmediate=function(t){setTimeout(t,0)}),function(){var n=0,i=t.requestAnimationFrame,e=t.cancelAnimationFrame;if(!i)for(var o=["ms","moz","webkit"],r=0;r<o.length&&!t.requestAnimationFrame;++r)i=t[o[r]+"RequestAnimationFrame"],e=t[o[r]+"CancelAnimationFrame"]||t[o[r]+"CancelRequestAnimationFrame"];i||(i=function(i){var e=Date.now(),o=Math.max(0,16-(e-n)),r=t.setTimeout(function(){i(e+o)},o);return n=e+o,r}),e||(e=function(t){clearTimeout(t)}),t.requestAnimationFrame=i,t.cancelAnimationFrame=e}()}(window),function(){"use strict";var t=0;$.fn.forEach=Array.prototype.forEach,$.fn.id=function(){var n=this[0].id;return n||(n="e"+t++,this.attr("id",n)),n},$.fn.visible=function(t){return 0===arguments.length?this.is(":visible"):this.css("visibility",t?"visible":"hidden")};var n=$(document);$.on=$.fn.on.bind(n),$.off=$.fn.off.bind(n)}(window),function(){"use strict";move.prototype.rotateY=function(t){return this.transform("rotateY("+t+"deg)")},move.prototype.rotateX=function(t){return this.transform("rotateX("+t+"deg)")},move.prototype.opacity=function(t){return this.set("opacity",t)}}(window),function(t){"use strict";t.utils={hideKeyboard:function(){var t=document.querySelector(":focus");t&&t.blur&&t.blur()}}}(window),function(t){"use strict";var n=$(t),i=$("body"),e=t.router={history:[],back:function(t){var n=e.history.pop(),i=e.history.last();transition.back(i,n,t)},section:function(t,n){var i=current.section,o=$(t);return e.history.push(o),i?transition.forward(o,i,n):(o.visible(!0).insertAfter($("section:last")),n&&n()),o},aside:function o(t,r){"function"==typeof t&&(r=t,t=null);var s=t?$(t):null,a=function(){transition.toggleClasses(!1),r&&r()};return!t||current.aside&&s[0]==current.aside[0]?(transition.toggleClasses(!0),transition.move("body").x(0).end(a),void(current.aside=null)):(current.aside?e.aside(o.bind(e,t,r)):(current.aside=s,transition.toggleClasses(!0),transition.move(i).x(n.width()*constants.ASIDE_WIDTH|0).end(a)),s)}}}(window),function(t){"use strict";var n=$(t),i=$("html"),e=t.transition={move:function(n){return n="string"==typeof n?$(n)[0]:n.length>0?n[0]:n,t.move(n).duration(constants.DURATION).ease(constants.EASE)},toggleClasses:function(t){i.toggleClass("routing",t).toggleClass("not-routing",!t)},forward:function(t,n,i){var o=t.data("transition")||constants.TRANSITION;e.toggleClasses(!0),t.visible(!0).insertAfter(n),e.showing(t),e.hiding(n);var r=move(t.length>0?t[0]:t).duration(0);e.reset(r,"section",o),r.end(function(){var r=e.move(t),s=e.move(n),a=e.get("section",o);a(r,s),r.end(function(){e.toggleClasses(!1),i&&i()}),s.end(function(){n.visible(!1)})})},back:function(t,n,i){e.toggleClasses(!0),e.showing(t),e.hiding(n);var o=n.data("transition")||constants.TRANSITION,r=e.move(n),s=e.move(t);e.reset(s,"section"),e.reset(r,"section",o),t.visible(!0),s.end(function(){t.insertAfter(n),e.toggleClasses(!1),i&&i()}),r.end(function(){n.visible(!1)})},showing:function(t){t.addClass("showing").trigger("showing")},shown:function(t){t.addClass("shown").removeClass("showing hidden").trigger("shown")},hiding:function(t){t.addClass("hiding").trigger("hiding")},hidden:function(t){t.addClass("hidden").removeClass("hiding shown").trigger("hidden")},show:function(t,n,i){e.showing(t);var o=e.move(t);e.reset(o,n,i),o.duration(0).end(function(){var o=e.move(t);e.get(n,i)(o),o.end(function(){e.shown(t)})})},hide:function(t,n,i){e.hiding(t);var o=e.move(t);e.reset(o,n,i),o.end(function(){e.hidden(t)})},get:function(t,n,i){var o=e[t]||e,r=o[n]||o;return r=r[i||"run"]||r},reset:function o(t,n,i){t.opacity(1).translate(0,0).rotate(0).scale(1);var r=e.get(n,i,"reset");return r!==o&&$.isFunction(r)&&r(t),t},section:{rotate:{reset:function(t){t.opacity(0).x(n.width()/2).rotate(15).y(n.height()/3).scale(1)},run:function(t){t.y(0).x(0).scale(1).rotate(0).opacity(1)}},slide:{reset:function(t){t.x(n.width())},run:function(t,n){t.x(0),n.opacity(0).rotateY(-45)}},slip:{reset:function(t){t.x(n.width())},run:function(t,i){t.x(0),i.x(-n.width()/2)}},cover:{reset:function(t){t.y(n.height())},run:function(t,n){t.y(0),n.rotateX(25).opacity(0)}}},modal:{reset:function(t){t.opacity(0).duration(constants.DURATION/4|0)},run:function(t){t.opacity(1).duration(constants.DURATION/4|0)}},prompt:{reset:function(t){t.y(n.height()/5).opacity(0).duration(constants.DURATION/3|0)},run:function(t){t.y(0).opacity(1).duration(constants.DURATION/3|0)}}}}(window),function(t,n){"use strict";function i(t,n,i){return n=Array.from(n),n.unshift(i),Function.prototype.bind.apply(t,n)}function e(){var t=f;f=null,t&&t()}function o(t,n){t?transition.show(u,"prompt",n):transition.hide(u,"prompt",d)}function r(t,n,e,a){return a=c(a),u?v!==g.HIDDEN?void s(!1,i(r,arguments)):(u.html(t).removeAttr("class").attr("class","notification-window").addClass(e).css({width:.8*p.width()|0,height:"auto"}),u.css({height:0|Math.min(u.height(),.8*p.height()),left:(p.width()-u.width())/2|0}),u.css({top:(p.height()-u.height())/2|0}),transition.show(l,"modal"),clearTimeout(h),u.one("shown",function(){d=e,n>0?h=setTimeout(s.bind(null,null,a),1e3*n):u.one("hidden",a)}),void o(!0,e)):(l=$('<div class="notification"/>').appendTo("body"),u=$('<div class="notification-window"/>').appendTo("body").on("hidden showing shown hiding",function(t){v=t.type}).on("tap",function(t){t.isDefaultPrevented()||y.hide()}),void setTimeout(i(r,arguments),20))}function s(t,n){return n=c(n),v==g.HIDDEN?void m(n):v===g.SHOWING?void u.one("shown",i(s,arguments)):(f=function(){m(n)},void(v===g.SHOWN&&(u.one("hidden",e),o(!1),t!==!1&&transition.hide(l,"modal"))))}function a(t,n,i){var e=$(document.createDocumentFragment());return i&&$('<span class="icon"/>').addClass(i).appendTo(e),t&&$('<strong class="text bold" />').html(t).appendTo(e),$("<small />").html(n||"").appendTo(e),e}function c(t){return t?function(){var n=t;t=null,n&&n.apply(this,arguments)}:$.noop}var u,l,d,h,f,p=$(t),m=t.setImmediate,g={};"hidden showing shown hiding".split(" ").forEach(function(t){g[t.toUpperCase()]=t});var v=g.HIDDEN,y=t.notification={show:function(t,n,i,e,o){var s;return s=t?a(t,n,i):'<div data-loading="white" />',r(s,e,null,o)},hide:function(){s()},error:function w(t,n,i,e,o){if("object"===$.type(t)){var s=t;return w.call(this,s.title,s.description,s.icon,s.duration,s.callback)}return r(a(t,n,i||"remove-sign"),e,"error",o)},success:function b(t,n,i,e,o){if("object"===$.type(t)){var s=t;return b.call(this,s.title,s.description,s.icon,s.duration,s.callback)}return r(a(t,n,i||"ok"),e,"success",o)},successThenBack:function A(t,n,i,e,o){return"object"===$.type(t)&&"title"in t?A(t.title,t.description,t.icon,t.duration,t.callback):void y.success(t,n,i,e,function(){router.back(),o&&o.apply(null,arguments)})},errorThenBack:function T(t,n,i,e,o){return"object"===$.type(t)&&"title"in t?T(t.title,t.description,t.icon,t.duration,t.callback):void y.error(t,n,i,e,function(){router.back(),o&&o.apply(null,arguments)})},html:function(t,n,i,e){return r(t,null,"html "+i,e)},push:function(i,e,o){var r=i;"object"==typeof r&&(i=r.text,e=r.duration,o=r.callback);var s=$('<div class="notification push" />');if(s.text(i).appendTo("body").style("top",-screen.height).show().style("top",-s.height()),r.canDismiss!==!1){$('<span class="dismiss icon remove on-right"></span>').prependTo(s);var a=0,c=0,u=0,l=s[0].style,d=!0;s.on("touchstart",function(t){a=c=t.touches&&t.touches[0]?t.touches[0].pageY:t.pageY,u=0,d=Date.now()}).on("touchmove",function(t){if(d){var n=t.touches&&t.touches[0]?t.touches[0].pageY:t.pageY;u+=c>n?1:-1,c=n;var i=c-a;0>=i&&(l.top=i+"px")}}).on("touchend",function(){d=!1,u>3?(e=100,h(),r.dismiss&&r.dismiss.apply(s[0])):l.top="0px",u=0})}var h=function(){t.setImmediate(function(){s&&s[0]&&move(s[0]).set("top",-s.height()).duration(e).end()}),setTimeout(function(){s&&s[0]&&(s.remove(),l=n,s=n,r=n)},constants.DURATION)};r.className&&s.addClass(r.className),s.one("tap",function(t){e=200,h(),$(t.target||t.srcElement).hasClass("dismiss")?r.dismiss&&r.dismiss.apply(this):o&&o.apply(this)}),t.setImmediate(function(){e=constants.DURATION,move(s[0]).set("top",0).duration(e).end()}),setTimeout(h,1e3*(e||5))},multi:function(t){if(t){t.items||(t={items:t});var n=a(t.title||t.text,t.description,t.icon);if(!Array.isArray(t.items)){var i=t.items;t.items=Object.keys(i).map(function(t){var n=i[t];return $.isFunction(n)?{callback:n,label:t}:(n.label||(n.label=t),n)})}return t.items.forEach(function(t){$('<button class="anchor" />').addClass(t.className||"").text(t.label||"").on("tap",function(){t.callback&&u.one("hidden",t.callback),y.hide()}).appendTo(n)}),utils.hideKeyboard(),y.html(n,null,t.className||"multi",t.callback||$.noop)}},confirm:function(t){return this.multi({title:t.title,description:t.description,className:"confirm",items:{accept:t.accept,cancel:Object.assign(t.cancel,{className:"text red"})}})}}}(window),function(t){"use strict";function n(t){var n=t.touches||(t.originalEvent?t.originalEvent.touches:null);return n&&n.length>0?n[0].pageX:t.pageX}var i=$(t),e=$("body"),o=$("html"),r=t.current={article:null,aside:null};Object.defineProperty(r,"section",{get:function(){return router.history.last()}});var s=t.constants={DURATION:400,EASE:"in-out",ASIDE_WIDTH:.7,TRANSITION:"slip"};i.on("resize deviceorientationchange init",function(){var t=i.height(),n=i.width(),r=$("aside"),a=$("section");r.height(t).css({right:n,width:n*s.ASIDE_WIDTH|0}).insertAfter(a.last()),e.width(n).height(t),o.toggleClass("portrait",t>n).toggleClass("landscape",n>t),a.height(t).width(n),a.forEach(function(n){n=$(n);var i=n.children("header:visible");i.addClass("cf");var e=n.children("footers:visible"),o=n.children("article"),r=i.height(),s=e.height();o.forEach(function(n){n=$(n),n.height(t-r-s)})})}),$(function(){i.trigger("init"),transition.toggleClasses(!1),router.section("#main"),$("aside").visible(!0)}),$.on("tap",".not-routing [data-section]",function(t){t.preventDefault();var n=$(this).data("section");"back"===n?router.back():router.section("#"+n)}).on("tap",".not-routing [data-aside]",function(t){t.preventDefault(),router.aside("#"+$(this).data("aside"))}),function(){var t,i,o,r;$.on("touchstart mousedown",".not-routing [data-aside]",function(e){return t=n(e),r=0,i=$("#"+$(this).data("aside")),0===i.length?void(i=null):void(o=i.width())}).on("touchmove mousemove",function(s){i&&(s.preventDefault(),r=n(s)-t,r=Math.max(0,r),r=Math.min(o,r),e.css("transform","translateX("+r+"px)"))}).on("touchend mouseup",function(t){if(i){if(0!==r){t.preventDefault();var n=r>o/2;n?router.aside(i):router.aside()}i=null}})}()}(window);
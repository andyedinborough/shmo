!function(){"use strict";Array.prototype.last=function(){return this[this.length-1]}}(window),function(){"use strict";var t=0;$.fn.forEach=Array.prototype.forEach,$.fn.id=function(){var n=this[0].id;return n||(n="e"+t++,this.attr("id",n)),n},$.fn.visible=function(t){return 0===arguments.length?this.is(":visible"):this.css("visibility",t?"visible":"hidden")}}(window),function(){"use strict";move.prototype.rotateY=function(t){return this.transform("rotateY("+t+"deg)")},move.prototype.rotateX=function(t){return this.transform("rotateX("+t+"deg)")},move.prototype.opacity=function(t){return this.set("opacity",t)}}(window),function(t){"use strict";var n=$(t),e=$("body"),i={history:[],back:function(t){var n=i.history.pop(),e=i.history.last();transition.back(e,n,t)},section:function(t,n){var o=current.section,r=$(t);return i.history.push(r),o?transition.forward(r,o,n):(r.visible(!0).appendTo(e),n&&n()),r},aside:function o(t,r){"function"==typeof t&&(r=t,t=null);var s=t?$(t):null,a=function(){transition.toggleClasses(!1),r&&r()};return!t||current.aside&&s[0]==current.aside[0]?(transition.toggleClasses(!0),transition.move("body").x(0).end(a),void(current.aside=null)):(current.aside?i.aside(o.bind(i,t,r)):(current.aside=s,transition.toggleClasses(!0),transition.move(e).x(n.width()*constants.ASIDE_WIDTH).end(a)),s)}};t.router=i}(window),function(t){"use strict";var n=$(t),e=$("html"),i={move:function(n){return n="string"==typeof n?$(n)[0]:n.length>0?n[0]:n,t.move(n).duration(constants.DURATION).ease(constants.EASE)},toggleClasses:function(t){e.toggleClass("routing",t).toggleClass("not-routing",!t)},get:function(t){t=t||"slide";var n=i[t];if(n)return n=n.run||n,"function"==typeof n?n:i.get(null)},forward:function(t,n,e){var o=t.data("transition")||"slide";i.toggleClasses(!0),t.visible(!0).insertAfter(n);var r=move(t.length>0?t[0]:t).duration(0);i.reset(r,o),r.end(function(){var r=i.move(t),s=i.move(n),a=i.get(o);a(r,s),r.end(function(){i.toggleClasses(!1),e&&e()}),s.end()})},back:function(t,n,e){i.toggleClasses(!0);var o=n.data("transition")||"slide",r=i.move(n),s=i.move(t);i.reset(s),i.reset(r,o),s.end(function(){t.insertAfter(n),i.toggleClasses(!1),e&&e()}),r.end()},reset:function(t,n){return t.opacity(1).translate(0,0).rotate(0).scale(1),n&&i[n]&&i[n].reset&&i[n].reset(t),t},rotate:{reset:function(t){t.opacity(0).x(n.width()/2).rotate(15).y(n.height()/3).scale(1)},run:function(t){t.y(0).x(0).scale(1).rotate(0).opacity(1)}},slide:{reset:function(t){t.x(n.width())},run:function(t,n){t.x(0),n.opacity(0).rotateY(-45)}},cover:{reset:function(t){t.y(n.height())},run:function(t,n){t.y(0),n.rotateX(25).opacity(0)}}};t.transition=i}(window),function(t){"use strict";var n=$(t),e=$("body"),i=$("html"),o=t.current={article:null,aside:null};Object.defineProperty(o,"section",{get:function(){return router.history.last()}});var r=t.constants={DURATION:400,EASE:"in-out",ASIDE_WIDTH:.7};n.on("resize deviceorientationchange init",function(){var t=n.height(),o=n.width(),s=$("aside");s.height(t).css({right:o,width:o*r.ASIDE_WIDTH}),e.width(o).height(t),i.toggleClass("portrait",t>o).toggleClass("landscape",o>t);var a=$("section");a.height(t).width(o),a.forEach(function(n){n=$(n);var e=n.children("header:visible");e.addClass("cf");var i=n.children("footers:visible"),o=n.children("article"),r=e.height(),s=i.height();o.forEach(function(n){n=$(n),n.height(t-r-s)})})}),$(function(){n.trigger("init"),transition.toggleClasses(!1),router.section("#main")}),$(document).on("tap",".not-routing [data-section]",function(t){t.preventDefault();var n=$(this).data("section");"back"===n?router.back():router.section("#"+n)}).on("tap",".not-routing [data-aside]",function(t){t.preventDefault(),router.aside("#"+$(this).data("aside"))})}(window);